ATTENTION: This operation should not be executed in a production environment.

CREATE TABLE athletes (id INT AUTO_INCREMENT NOT NULL, club_id INT NOT NULL, last_name VARCHAR(20) NOT NULL, first_name VARCHAR(20) NOT NULL, gender VARCHAR(6) NOT NULL, birthday DATE NOT NULL, country VARCHAR(2) NOT NULL, is_active TINYINT(1) NOT NULL, zip VARCHAR(10) NOT NULL, city VARCHAR(70) NOT NULL, street VARCHAR(70) NOT NULL, singles_rating SMALLINT DEFAULT NULL, doubles_rating SMALLINT DEFAULT NULL, mixed_rating SMALLINT DEFAULT NULL, singles_matches SMALLINT NOT NULL, doubles_matches SMALLINT NOT NULL, mixed_matches SMALLINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX IDX_57A7E4D661190A32 (club_id), INDEX is_active_index (is_active), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE clubs (id INT AUTO_INCREMENT NOT NULL, contact_person_id INT DEFAULT NULL, club_syndicate_1 INT DEFAULT NULL, club_syndicate_2 INT DEFAULT NULL, club_syndicate_3 INT DEFAULT NULL, club_syndicate_4 INT DEFAULT NULL, code VARCHAR(10) NOT NULL, name VARCHAR(100) NOT NULL, website VARCHAR(255) NOT NULL, logo VARCHAR(100) NOT NULL, description LONGTEXT NOT NULL, updated_at DATETIME NOT NULL, UNIQUE INDEX UNIQ_A5BD312377153098 (code), INDEX IDX_A5BD31234F8A983C (contact_person_id), INDEX IDX_A5BD3123EA49D22E (club_syndicate_1), INDEX IDX_A5BD312373408394 (club_syndicate_2), INDEX IDX_A5BD3123447B302 (club_syndicate_3), INDEX IDX_A5BD31239A2326A1 (club_syndicate_4), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE comments (id INT AUTO_INCREMENT NOT NULL, author_id INT NOT NULL, teammatch_id INT NOT NULL, match_id INT DEFAULT NULL, title VARCHAR(100) NOT NULL, message LONGTEXT NOT NULL, INDEX IDX_5F9E962AF675F31B (author_id), INDEX IDX_5F9E962AA18F3C9C (teammatch_id), INDEX IDX_5F9E962A2ABEACD6 (match_id), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE games (id INT AUTO_INCREMENT NOT NULL, match_id INT NOT NULL, game_sequence SMALLINT NOT NULL, team1_score SMALLINT NOT NULL, team2_score SMALLINT NOT NULL, annulled TINYINT(1) NOT NULL, INDEX IDX_FF232B312ABEACD6 (match_id), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE leagues (id INT AUTO_INCREMENT NOT NULL, tournament_id INT NOT NULL, class_abbr VARCHAR(10) NOT NULL, class_name VARCHAR(50) NOT NULL, class_level SMALLINT NOT NULL, division SMALLINT NOT NULL, promoted_number SMALLINT NOT NULL, relegated_number SMALLINT NOT NULL, INDEX IDX_85CE39E33D1A3E7 (tournament_id), UNIQUE INDEX league_index (class_abbr, division, tournament_id), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE lineups (stage SMALLINT NOT NULL, team_id INT NOT NULL, athlete_id INT NOT NULL, position SMALLINT NOT NULL, INDEX IDX_60729AAB296CD8AE (team_id), INDEX IDX_60729AABFE6BCB8B (athlete_id), PRIMARY KEY(stage, team_id, athlete_id)) ENGINE = InnoDB;
CREATE TABLE matches (id INT AUTO_INCREMENT NOT NULL, teammatch_id INT NOT NULL, match_type_id INT NOT NULL, team1_player_id INT DEFAULT NULL, team1_partner_id INT DEFAULT NULL, team2_player_id INT DEFAULT NULL, team2_partner_id INT DEFAULT NULL, team1_score SMALLINT DEFAULT NULL, team2_score SMALLINT DEFAULT NULL, team1_points SMALLINT NOT NULL, team2_points SMALLINT NOT NULL, no_fight TINYINT(1) NOT NULL, given_up_by SMALLINT NOT NULL, revised_score TINYINT(1) NOT NULL, team1_original_score SMALLINT DEFAULT NULL, team2_original_score SMALLINT DEFAULT NULL, team1_original_points SMALLINT DEFAULT NULL, team2_original_points SMALLINT DEFAULT NULL, avg_orig_smaller_div_bigger_gamescore_permil SMALLINT DEFAULT NULL, std_orig_smaller_div_bigger_gamescore_permil SMALLINT DEFAULT NULL, updated_at DATETIME NOT NULL, INDEX IDX_62615BAA18F3C9C (teammatch_id), INDEX IDX_62615BAB2EAD3FC (match_type_id), INDEX IDX_62615BAE8019B39 (team1_player_id), INDEX IDX_62615BADA8B58DD (team1_partner_id), INDEX IDX_62615BA71E3FD38 (team2_player_id), INDEX IDX_62615BAAD158A2D (team2_partner_id), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE match_types (id INT AUTO_INCREMENT NOT NULL, name VARCHAR(20) NOT NULL, x_on_x SMALLINT NOT NULL, gender SMALLINT NOT NULL, PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE ratinghistory (id INT AUTO_INCREMENT NOT NULL, athlete_id INT NOT NULL, match_id INT NOT NULL, discipline VARCHAR(7) NOT NULL, pre_rating SMALLINT DEFAULT NULL, post_rating SMALLINT DEFAULT NULL, created_at DATE NOT NULL, INDEX IDX_F17BFD40FE6BCB8B (athlete_id), INDEX IDX_F17BFD402ABEACD6 (match_id), INDEX rating_date_index (created_at), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE teams (id INT AUTO_INCREMENT NOT NULL, club_id INT NOT NULL, league_id INT NOT NULL, team_number SMALLINT NOT NULL, withdrawn TINYINT(1) NOT NULL, description LONGTEXT NOT NULL, updated_at DATETIME NOT NULL, INDEX IDX_96C2225861190A32 (club_id), INDEX IDX_96C2225858AFC4DE (league_id), UNIQUE INDEX team_index (team_number, league_id, club_id), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE teammatches (id INT AUTO_INCREMENT NOT NULL, venue_id INT DEFAULT NULL, team1_id INT NOT NULL, team2_id INT NOT NULL, submitted_by_id INT DEFAULT NULL, confirmed_by_id INT DEFAULT NULL, approved_by_id INT DEFAULT NULL, scheduled_at DATETIME NOT NULL, moved_at DATETIME DEFAULT NULL, performed_at DATETIME NOT NULL, stage SMALLINT NOT NULL, team1_score SMALLINT DEFAULT NULL, team2_score SMALLINT DEFAULT NULL, team1_games SMALLINT DEFAULT NULL, team2_games SMALLINT DEFAULT NULL, team1_points SMALLINT DEFAULT NULL, team2_points SMALLINT DEFAULT NULL, no_fight TINYINT(1) NOT NULL, annulled TINYINT(1) NOT NULL, revised_score TINYINT(1) NOT NULL, revaluation_wrongdoer SMALLINT NOT NULL, revaluation_reason SMALLINT NOT NULL, incomplete_lineup TINYINT(1) NOT NULL, submitted_at DATETIME DEFAULT NULL, confirmed_at DATETIME DEFAULT NULL, approved_at DATETIME DEFAULT NULL, description LONGTEXT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX IDX_890EB5E040A73EBA (venue_id), INDEX IDX_890EB5E0E72BCFA4 (team1_id), INDEX IDX_890EB5E0F59E604A (team2_id), INDEX IDX_890EB5E079F7D87D (submitted_by_id), INDEX IDX_890EB5E06F45385D (confirmed_by_id), INDEX IDX_890EB5E02D234F6A (approved_by_id), INDEX performed_at_index (performed_at), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE tournaments (id INT AUTO_INCREMENT NOT NULL, owner_id INT NOT NULL, host_id INT DEFAULT NULL, short_name VARCHAR(40) NOT NULL, full_name VARCHAR(100) NOT NULL, season VARCHAR(10) NOT NULL, slug VARCHAR(40) NOT NULL, start_date DATE NOT NULL, end_date DATE NOT NULL, sport VARCHAR(20) NOT NULL, INDEX IDX_E4BCFAC37E3C61F9 (owner_id), INDEX IDX_E4BCFAC31FB8D185 (host_id), UNIQUE INDEX slug_index (slug, owner_id), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE users (id INT AUTO_INCREMENT NOT NULL, athlete_id INT DEFAULT NULL, username VARCHAR(50) NOT NULL, slug VARCHAR(40) NOT NULL, full_name VARCHAR(100) NOT NULL, email VARCHAR(255) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, UNIQUE INDEX UNIQ_1483A5E9F85E0677 (username), UNIQUE INDEX UNIQ_1483A5E9989D9B62 (slug), UNIQUE INDEX UNIQ_1483A5E9FE6BCB8B (athlete_id), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE venues (id INT AUTO_INCREMENT NOT NULL, code VARCHAR(10) NOT NULL, zip VARCHAR(10) NOT NULL, city VARCHAR(70) NOT NULL, street VARCHAR(70) NOT NULL, latitude VARCHAR(10) NOT NULL, longitude VARCHAR(10) NOT NULL, description LONGTEXT NOT NULL, updated_at DATETIME NOT NULL, UNIQUE INDEX UNIQ_652E22AD77153098 (code), PRIMARY KEY(id)) ENGINE = InnoDB;
ALTER TABLE athletes ADD CONSTRAINT FK_57A7E4D661190A32 FOREIGN KEY (club_id) REFERENCES clubs(id);
ALTER TABLE clubs ADD CONSTRAINT FK_A5BD31234F8A983C FOREIGN KEY (contact_person_id) REFERENCES athletes(id);
ALTER TABLE clubs ADD CONSTRAINT FK_A5BD3123EA49D22E FOREIGN KEY (club_syndicate_1) REFERENCES clubs(id);
ALTER TABLE clubs ADD CONSTRAINT FK_A5BD312373408394 FOREIGN KEY (club_syndicate_2) REFERENCES clubs(id);
ALTER TABLE clubs ADD CONSTRAINT FK_A5BD3123447B302 FOREIGN KEY (club_syndicate_3) REFERENCES clubs(id);
ALTER TABLE clubs ADD CONSTRAINT FK_A5BD31239A2326A1 FOREIGN KEY (club_syndicate_4) REFERENCES clubs(id);
ALTER TABLE comments ADD CONSTRAINT FK_5F9E962AF675F31B FOREIGN KEY (author_id) REFERENCES users(id);
ALTER TABLE comments ADD CONSTRAINT FK_5F9E962AA18F3C9C FOREIGN KEY (teammatch_id) REFERENCES teammatches(id);
ALTER TABLE comments ADD CONSTRAINT FK_5F9E962A2ABEACD6 FOREIGN KEY (match_id) REFERENCES matches(id);
ALTER TABLE games ADD CONSTRAINT FK_FF232B312ABEACD6 FOREIGN KEY (match_id) REFERENCES matches(id) ON DELETE CASCADE;
ALTER TABLE leagues ADD CONSTRAINT FK_85CE39E33D1A3E7 FOREIGN KEY (tournament_id) REFERENCES tournaments(id);
ALTER TABLE lineups ADD CONSTRAINT FK_60729AAB296CD8AE FOREIGN KEY (team_id) REFERENCES teams(id);
ALTER TABLE lineups ADD CONSTRAINT FK_60729AABFE6BCB8B FOREIGN KEY (athlete_id) REFERENCES athletes(id);
ALTER TABLE matches ADD CONSTRAINT FK_62615BAA18F3C9C FOREIGN KEY (teammatch_id) REFERENCES teammatches(id) ON DELETE CASCADE;
ALTER TABLE matches ADD CONSTRAINT FK_62615BAB2EAD3FC FOREIGN KEY (match_type_id) REFERENCES match_types(id);
ALTER TABLE matches ADD CONSTRAINT FK_62615BAE8019B39 FOREIGN KEY (team1_player_id) REFERENCES athletes(id);
ALTER TABLE matches ADD CONSTRAINT FK_62615BADA8B58DD FOREIGN KEY (team1_partner_id) REFERENCES athletes(id);
ALTER TABLE matches ADD CONSTRAINT FK_62615BA71E3FD38 FOREIGN KEY (team2_player_id) REFERENCES athletes(id);
ALTER TABLE matches ADD CONSTRAINT FK_62615BAAD158A2D FOREIGN KEY (team2_partner_id) REFERENCES athletes(id);
ALTER TABLE ratinghistory ADD CONSTRAINT FK_F17BFD40FE6BCB8B FOREIGN KEY (athlete_id) REFERENCES athletes(id);
ALTER TABLE ratinghistory ADD CONSTRAINT FK_F17BFD402ABEACD6 FOREIGN KEY (match_id) REFERENCES matches(id);
ALTER TABLE teams ADD CONSTRAINT FK_96C2225861190A32 FOREIGN KEY (club_id) REFERENCES clubs(id);
ALTER TABLE teams ADD CONSTRAINT FK_96C2225858AFC4DE FOREIGN KEY (league_id) REFERENCES leagues(id);
ALTER TABLE teammatches ADD CONSTRAINT FK_890EB5E040A73EBA FOREIGN KEY (venue_id) REFERENCES venues(id) ON UPDATE CASCADE ON DELETE SET NULL;
ALTER TABLE teammatches ADD CONSTRAINT FK_890EB5E0E72BCFA4 FOREIGN KEY (team1_id) REFERENCES teams(id);
ALTER TABLE teammatches ADD CONSTRAINT FK_890EB5E0F59E604A FOREIGN KEY (team2_id) REFERENCES teams(id);
ALTER TABLE teammatches ADD CONSTRAINT FK_890EB5E079F7D87D FOREIGN KEY (submitted_by_id) REFERENCES users(id);
ALTER TABLE teammatches ADD CONSTRAINT FK_890EB5E06F45385D FOREIGN KEY (confirmed_by_id) REFERENCES users(id);
ALTER TABLE teammatches ADD CONSTRAINT FK_890EB5E02D234F6A FOREIGN KEY (approved_by_id) REFERENCES users(id);
ALTER TABLE tournaments ADD CONSTRAINT FK_E4BCFAC37E3C61F9 FOREIGN KEY (owner_id) REFERENCES users(id);
ALTER TABLE tournaments ADD CONSTRAINT FK_E4BCFAC31FB8D185 FOREIGN KEY (host_id) REFERENCES clubs(id);
ALTER TABLE users ADD CONSTRAINT FK_1483A5E9FE6BCB8B FOREIGN KEY (athlete_id) REFERENCES athletes(id)
